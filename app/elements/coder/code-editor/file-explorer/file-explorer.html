<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="/bower_components/paper-material/paper-material.html">

<link rel="import" href="explorer-folder.html">
<link rel="import" href="context-menu.html">

<dom-module id="file-explorer">
	<template>
		<style include="iron-flex">
			#container {
				width: 200px;
			}
		</style>
		<context-menu id="contextMenu"></context-menu>
		<div id="container" style$="{{contentStyle}}">
			<explorer-folder meta="{{rootFolder}}"></explorer-folder>
		</div>
	</template>
	<script>
		Polymer({
			is: 'file-explorer',
			properties: {
				rootFolder: {
					type: Object,
					notify: true
				},
				visible: {
					type: Boolean,
					value: true
				},
				contentStyle :{
					type: String,
					value: ''
				},
				selectedFile: {
					type: Object,
					notify: true
				}
			},
			listeners: {
				'show-menu': '_showMenu',
				'file-selected': '_fileSelected'
			},
			ready: function(){
				this.rootFolder = {
					'name': 'root',
					'isFolder': true,
					'order': 0,
					'isRoot': true
				};
			},
			_showMenu: function(event, data){
				this.$.contextMenu.showMenu(data);
			},
			toggle: function(){
				if (this.visible){
					this.contentStyle = 'display: none';
				}else{
					this.contentStyle = '';
				}
				this.visible = !this.visible;
			},
			_fileSelected: function(e, detail){
				if (!!this.selectedFile){
					this.selectedFile.markUnselected();
				}
				this.selectedFile = detail;
				this.selectedFile.markSelected();
			},
			fileContentChanged: function(content){
				this.selectedFile.setContent(content);
			},
			getFiles: function(){
				return this.rootFolder;
			}
		});
	</script>
</dom-module>