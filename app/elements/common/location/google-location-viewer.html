<link rel="import" href="../../../bower_components/google-map/google-map.html">

<dom-module id="google-location-viewer">
	<template>
		<style>
			google-map {
				height: 600px;
			}
		</style>
		<div id="container">
			<google-map id="map"
						api-key="[[apiConfig.apiKey]]"
						version="[[apiConfig.version]]"
						map="{{map}}"
						latitude="[[location.latitude]]"
						longitude="[[location.longitude]]"
						zoom="16">
				<google-map-marker
					id="marker"
					marker="{{marker}}"
					latitude="[[location.latitude]]"
					longitude="[[location.longitude]]">
					<div><strong>[[location.name]]</strong></div>
					<div>[[location.address]]</div>
				</google-map-marker>
			</google-map>
		</div>
	</template>
	<script type="application/javascript" src="../../../scripts/behaviors/google-maps-host-behavior.js"></script>
	<script>
		Polymer({
			is: 'google-location-viewer',
			behaviors: [
				Behaviors.GoogleMapsHostBehavior
			],
			observers: [
				'_locationSet(map, location)'
			],
			_locationSet(map, location) {
				if (!map || !location){
					return;
				}
				this.$.marker.map = Object.create(this.map);
				this.map.setCenter({lat: this.location.latitude, lng: this.location.longitude});
			},
			toggleVisibility: function() {
				if (!!this.visible) {
					this.show();
				} else {
					this.hide();
				}
			},
			show: function() {
				this.$.container.style.display = '';
				this.$.map.resize();
				this.$.marker.open = true;
				this.visible = !this.visible;
			},
			hide: function() {
				this.$.container.style.display = 'none';
				this.visible = !this.visible;
			}
		});
	</script>
</dom-module>